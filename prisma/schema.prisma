generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

//
// ENUMS
//

enum Role {
  USER
  ADMIN
}

//
// MODELS
//

model User {
  id          String   @id @default(uuid())
  email       String   @unique
  password    String
  first_name  String?
  last_name   String?
  role        Role     @default(USER)

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  activities   Activity[]
  aiResponses  AIResponse[]

  @@index([email])
}

model ActivityType {
  id          String   @id @default(uuid())
  name        String   @unique
  description String?
  icon        String?
  createdAt   DateTime @default(now())

  activities  Activity[]
}

model Activity {
  id        String       @id @default(uuid())
  userId    String
  typeId    String?      // temporar optional
  duration  Int?         // minute
  calories  Int?         // calorii estimate
  date      DateTime?

  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt

  user      User?        @relation(fields: [userId], references: [id], onDelete: Cascade)
  type      ActivityType? @relation(fields: [typeId], references: [id])
  aiResponses AIResponse[]

  @@index([userId])
  @@index([typeId])
}

model AIResponse {
  id            String   @id @default(uuid())
  userId        String
  activityId    String
  recommendedAt DateTime @default(now())
  notes         String?

  user     User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  activity Activity @relation(fields: [activityId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([activityId])
}